CREATE TABLE t (
    id INTEGER,
    value DOUBLE
);


// Linear
INSERT INTO t
SELECT 
    id,
    CAST(id AS DOUBLE) AS value
FROM range(1, 10001) AS r(id);

// Uniform
INSERT INTO t
SELECT
    id,
    random() * 100000   AS value,
    random() * 100000   AS value2
FROM range(1, 1001) AS r(id);

// Skewed 
INSERT INTO t
SELECT
    id,
    (exp(random() * 5) - 1) * 1000 AS value
FROM range(1, 10001) AS r(id);



CREATE INDEX idx_rmi ON t USING RMI (value) WITH (model = 'linear');


SELECT * FROM rmi_index_dump('idx_rmi') LIMIT 20;
SELECT * FROM rmi_index_model_stats('idx_rmi') LIMIT 20;
SELECT * FROM rmi_index_overflow('idx_rmi');
SELECT * FROM rmi_index_model_info('idx_rmi');

// Explain
explain select * from t where value < 5.0;
explain analyze select * from t where value < 5.0;

// Overflow Insert
insert into t (id, value) values (10001, 4.0, 53.212), (10020, 53.623548, 8892.38);

